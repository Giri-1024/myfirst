# 電資工程入門設計與實作 工作紀錄簿

**備註：因固定分組，本工作紀錄簿將沿用至學期末，請每週至此範本中複製內容至自己的紀錄簿並填寫**
## 組名
* 潗皸鋂釹牗
## 成員
* 班別：週四班
* 組員1：邱吉鈞 B08901099 暱稱: Giri
* 組員2：施彥宇 B08901085 暱稱: Xavier
* 組員3：徐有齊 B08901097 暱稱: 我Yo Chi我女朋Yo(欸搞啥啊)

* ## 第四週紀錄
* 課堂應完成事項(**下課前必須找助教檢查**)
    * (小組) 車子組裝完成Part 1(前側柱、馬達座)
    * (小組) 車子組裝完成Part 2(下盤)
    * (小組) 車子組裝完成Part 3(中盤)
    * (小組) 車子組裝完成Part 4(上蓋)
    * (小組) 車子通電可動作
    > 完成1234[name=erik]
    > 完成12345[name=培威] (禮拜六Lab)
* 實際達成事項（必填）
    * 完成part1-part4
    * 完成part1-part5      (禮拜六Lab)

* 組內討論事項 (必填)
    
    * 配線紀錄：
       * 左馬達L298N -> output 3,4
       * 右馬達L298N -> output 1,2

    * 未來組裝進度規劃：
       * 我們離開前拿了一些杜邦線，因此禮拜五可以自行在家裡接一些模組，然後禮拜六就可以直接拿給助教確認並通電
       * 測試用的程式已經寫完了

    * 天馬行空：
       * 我（有齊）之前在網路上看到一個訓練車子循跡的神經網路的影片，連結如下(https://youtu.be/Aut32pR5PQA)，不知道能不能用在這次的專案（不過技術上有點難⋯）
* 組員分工 (必填)
    * 有齊:　上蓋、程式、工作紀錄簿、接線、測試
        ![](https://i.imgur.com/noYq1lm.jpg)



    * 吉鈞:　中蓋、焊接、工作紀錄簿、接線、測試
         ![](https://i.imgur.com/C6vArBR.jpg)
         ![](https://i.imgur.com/fGkLfSj.jpg)


    * 彥宇:　底盤、各種sensor的組裝
          ![](https://i.imgur.com/VCj6ISo.jpg)




* 遇到的問題、處理狀況、解決方式 (必填)
    * 焊接順序有誤:
        * 開關焊接完之後發現電池的插頭（下圖黃色框框）無法穿過底盤預留給開關的洞（下圖紅色框框），因此無法組裝到底板上
        * 解決方案：重新焊接!
     ![](https://i.imgur.com/Ymv7Oxn.jpg)


    * 轉降壓版的螺絲發現螺絲起子太大
        * 解決方案：找小螺絲起子

    * 裝L298N時用來墊高的 10mm 銅柱不夠
       * 解決方案：用較長螺絲穿過底盤後，加一顆螺帽墊高，再放上L298N板子，再用一顆螺帽鎖住，如此也能把L298N墊高。

    * 鎖螺絲順序有誤:
       * 安裝馬達時，發現必須先把馬達鎖上馬達座，才能把整個馬達組裝上底盤。
       * 解決方案：拆掉重裝

    * 給Arduino供電的電線預留得太短：
      * 解決方案：把插頭穿過萬向輪以縮短距離，最終成功接上Arduino板

    * 電線容易纏在一起：
       * 解決方案：用膠帶把電線固定（如下圖黃框）
          ![](https://i.imgur.com/vFnXjPM.jpg)
          ![](https://i.imgur.com/3B86cM7.jpg)
    * 焊接 Aduino 電供公頭避免短路:
      * 原本因為要焊接，線頭都會習慣性留長，但這次焊接發現正極線頭留太長十分可能碰觸到負極的金屬。
      * 解決方案：將紅線重新焊接，使得可能會碰到負極金屬板的部分都是有電線皮包覆。
    * 焊槍在被焊物上停留太久:
        * 在重新焊接開關時為了清除殘餘的錫，焊槍接觸開關過久導致連結焊接點的塑膠融化
        * 解決方案：重新焊接一個新開關
   

* 課程建議 (選填)
    * 組裝說明可以更加詳細一些，尤其是組裝的順序，如此可避免一些我們遭遇到的問題
    * 10mm銅柱似乎用的比較兇
    * 課後看了一下杜邦線，母對母的線數量不多，但是這次用的模組大多得用母對母連接
* 想說的話 (選填)
    * 吉鈞： 
        * 錫煙真香~~~
        * 這次的焊槍很棒，恆溫而且焊接頭保養很好，吃錫零阻礙
    * 有齊： 
        * 每次遇到有很多電線的組裝就令人頭疼，像這次發生了預留的線太短的小意外，讓我們費了一些功夫才順利接起來。不過線到底要留多長真是一個大哉問，留長比較有彈性，但同時也容易造成混亂，NASA在阿波羅6號就發生過把A,B引擎的線接錯，結果飛行時A引擎故障卻把B引擎關掉，差點導致任務失敗。後來他們的解決方法就僅僅是把線縮短，進而防止交叉。因此我蠻認同彥宇把每一條線都仔細排好並貼上膠帶固定的精神，如此可以免去很多低級的錯誤。


## 第四週 週五（3/27）自行組裝紀錄
* 預計達成事項
    * 完成接線
    * 測試紅外線、RFID(不用接電池的模組)
* 實際達成事項
    * 完成接線!![](https://i.imgur.com/ZElLR67.jpg)

    
    * 測試完紅外線、RFID
    ![](https://i.imgur.com/e1cvYf3.jpg)
    (此圖為測試左邊三個紅外線感測器下方為黑色物質時的數值)
    ![](https://i.imgur.com/40srtZe.jpg)
    (此圖為紅外線感測器回傳的數據)

    * 測試馬達(超出預期進度)
        * 由於我們禮拜五晚上在學術部MKS進行組裝，因此確認所有接線無誤後就直接用MKS的電池進行測試，並且成功依序執行"前進"、"後退"、"左轉"、"右轉"等動作

    * 測試用的Arduino Code
        https://drive.google.com/drive/folders/1vIihFpJ35WSFW8Sm9WDAOVhNA7ztv5Jp?usp=sharing

* 組內討論事項 (必填)
    
    * 配線紀錄：
        * L298N
            * ENA = 6; // left
            * ENB = 3; // right
            * IN1 = 8;
            * IN2 = 7;
            * IN3 = 5;
            * IN4 = 4;
        * IR_sensor
            * A0  // left
            * A1
            * A2
            * A3
            * A4
            * A5  // right
    * 車輛微調
        * 由於重心稍微靠前，因此我們決定把萬向輪墊高兩個螺帽(如下圖)，如此便不會向前側方翻覆。
        ![](https://i.imgur.com/wtPchC3.jpg)
        
* 組員分工 (必填)
    * 有齊:　程式、工作紀錄簿、測試、買杜邦線
    https://drive.google.com/drive/folders/1vIihFpJ35WSFW8Sm9WDAOVhNA7ztv5Jp?usp=sharing (測試用的程式碼)

    * 吉鈞:　焊接、接線、測試
    ![](https://i.imgur.com/iBYQPYW.jpg)


    * 彥宇:　微調車輛


* 遇到的問題、處理狀況、解決方式 (必填)
    * 腳位不足
        * RFID 需要5個pin腳(不包含Vcc、gnd)
        * IR sensor 需要6個pin腳(投影片叫我們接Digital Output)
        * L298N 需要6個pin腳
        * 而Arduino Uno 只有 12 個 digital pin腳(不包含Tx、Rx)
        * 怎麼辦呢？
         ![](https://i.imgur.com/GolHvZR.png)
        * 於是我們跑到隔壁問了禮拜五班的助教
        * 助教也
         ![](https://i.imgur.com/GolHvZR.png)
         
        * 好吧，看來別無選擇了！
        ![](https://i.imgur.com/Q1tePrh.jpg)
        
        * 只好把所有的IR_sensor改成analog了!
        ![](https://i.imgur.com/KTInCFU.jpg)



         
         

    * RFID VCC 3.3V
        * 問題：
            * 之前RFID教學說要用3.3V供電，但是擴充版上沒有標示3.3V在哪
        * 解決方案：
            * 到MKS拿三用電表找，最後發現在一個不起眼的小角，上面還標示著"Bluetooth"
             ![](https://i.imgur.com/oTsjkM4.gif)
            (哇，HackMD竟然支援gif)

            * 後來助教跟我們說，其實RFID 5V也可以啦
    * 右側輪胎畸形卡住
        * 問題：
            * 右輪畸形(下圖中的輪胎有嚴重突起)
            ![](https://i.imgur.com/1JkZzXm.jpg)
        * 解決方案：
            * 換輪胎~


                
    * 杜邦線不夠
        * 問題：
            * 教室提供的杜邦線往往不夠長(20cm)，導致接線程序繁瑣又容易出錯
        * 解決方案：
            * 課金囉~
            * 我禮拜五下午殺去光華商場買了40條30cm母對母杜邦線 (55元)

* 課程建議 (選填)
    * 組裝說明可以更加詳細一些，而且有一些錯誤可能要修正。


## 第四週 週六（3/28） 0penLab
* 預計達成事項
    * 給助教確認完成本周進度

* 實際達成事項
    * 給助教確認完本周進度
    * 測試馬達的性能(最低轉速)
    * 自行完成藍芽遙控(超前進度)
    * 測試用程式碼：
https://drive.google.com/drive/folders/1vIihFpJ35WSFW8Sm9WDAOVhNA7ztv5Jp?usp=sharing

* 組內討論事項 (必填)
    * 馬達測試
        * 方式：
            * 用藍芽遙控車子，設定analogWrite初始為0
            * 每按一次'a'，analogWrite會增加10
            * 每按一次'd'，analogWrite會減少10
        * 結果：
            * 車子要開始移動的最小轉速：60
    * 更換萬向輪：
        * 目前的萬向輪常常導致車子在變換方向時會有嚴重的偏移
        * 討論是否要更換球型的萬向輪
        * 最後邱吉鈞弄到了球型萬向輪
    
        
* 組員分工 (必填)
    * 有齊:　程式、工作紀錄簿、測試
    https://drive.google.com/drive/folders/1vIihFpJ35WSFW8Sm9WDAOVhNA7ztv5Jp?usp=sharing (測試用的程式碼)

    * 吉鈞:　焊接、接線、測試、遙控駕駛員
    ![](https://i.imgur.com/hKIRffs.jpg)


* 遇到的問題、處理狀況、解決方式 (必填)
    * 我(有齊)的電腦連不太到藍芽
        * 之前教藍芽的時候就已經發生一直連不上藍芽的問題
        * 所以只好用吉鈞的電腦來遙控
        * 不過程式是用USB線上傳所以我還是能用我的電腦打code
    * 車子很難直走
        * 我們發現車子直行/倒退的時候會嚴重右偏/左偏
        * 而且直行跟倒退的偏移為"互斥事件"
        * 由於前進/後退/左轉/右轉四個動作只會有一個有嚴重偏移，故我們推測不是馬達的問題
        * 後來我們把萬向輪用膠帶固定，直走跟倒退都會變得很穩
        * 因此我們想試試看用球型萬向輪，看看能不能解決問題
    
    
* 想說的話 (選填)
    * 有齊：我發現很多同學都來不及組完，個人認為有很大的原因是簡報說明的不夠清楚，若是技術性的問題還可以查data sheet，但是最讓大家困擾的是一些經驗性的技巧，像是我們禮拜五就發現20公分的杜邦線接不到上蓋，Arduino Uno的數位腳位嚴重不足等。不過就另一個方面來說，這也是考驗各組同學面對工程問題的觀念和態度。我發現我們這一組的進度之所以能每每超前，正是因為我的隊友們都有很好的工程習慣，像是彥宇一定會把每條線都整理好並固定，吉鈞接線跟焊錫都非常仔細，而我們在組裝前通常都會先測量、演練一遍，因此我們馬上就發現20公分的杜邦線不夠長，以及Arduino腳位不足的問題，同時我們也很少發生接錯線等嚴重錯誤。因此我在想，也許一上課就開始動手不見得是最快的方法，更重要的是動手之前知不知道每一塊板子的接法，操作方式和安全守則，如果老師能在上課前讓我們仔細思考一下這些問題，或許組裝起來就會更得心應手。



## 第四週批閱區
* 助教批閱欄
    * 把遇到的問題和解決方法都寫得超級詳細，感覺可以拿來當工作紀錄簿範本了XD
    * 萬向輪的部份看到你們寫到用膠帶固定會好很多，後來換成球形萬向輪，看到你們分析很難直走但不是馬達的問題那邊，真的是分析的很清楚很棒，如果之後遇到問題也都用這個方法debug應該會省掉很多麻煩，其實在車車1.0和2.0的版本都是用球型萬向輪，現在這顆萬向輪可能還要再測試一陣子。還有看到你們用藍芽遙控測試馬達的方法也很棒，會進度這麼快真的不是沒道理的 (看到你們發現可以加gif我也要加)
    * ![](https://i.imgur.com/5EjcrPZ.gif)
    * 阿阿對了～記得取個炫砲組名寫在最前面喔～[name=Yen-yen Teng]
* 教授批閱欄
    * 教授評分等第
    A+
    * 教授回饋
        1. 如助教所說，的確寫得很好，我會推薦給其他老師參考，希望你們未來都能繼續保持良好工作習慣。
        2. 可以取個有趣的組名喔。  :D
        3. 我們的確希望在遇到問題時，同學們能夠靠自己或團隊解決問題。
        4. HackMD 是最近很流行的東西，所以我們拿它來讓大家來做工作紀錄簿。
        5. 很多資料放 Google 雲端統整這樣很好。不過我個人很反 Google，也可以考慮其他空間，如 dropbox
        6. 神經網路的影片，說不定在自選題可以做一些嘗試。無論結果如何，至少可多學一些機器學習的相關知識。
        [name=Jiun-Peng] 


    
## 第五週 週三(4/1) OpenLab
* 預計達成事項
    * 因為兩側控制馬達轉速會不一，所以我們打算找出兩側馬達在給定相同電壓下的轉速跟扭力，並依此來讓車車能夠在我們透過藍芽的控制下穩穩地走出直線、左轉、右轉跟後退的動作。

* 實際達成事項（必填）
    * 確認這個情況跟馬達比較無關。

    
    * 換上比較好轉的球形萬向輪(上次OpenLab提到的)。
    ![](https://i.imgur.com/jrqDM6E.jpg)
    * 利用鉤錶的三用電表測量並比較我們車上的L298N兩端輸出端的電壓差。
        * 發現數值一直晃 
        * 合理推測因為PWM
        * 決定採用示波器紀錄輸出結果
    ![](https://i.imgur.com/VXRqJdd.jpg)

    ![](https://i.imgur.com/v8PsDz5.jpg)

    * 利用電源供應器供應12Volt(c.v)搭配示波器測出車上和MakerSpace所有L298N的波形圖。
    ![](https://i.imgur.com/M6x1kFC.jpg) 
    
    * 示波器結果分析
        * 發現每顆L298N兩端(IN1,IN2)&(IN3,IN4)，以最高最低電壓(最低=0)以及平均電壓研判，通以相同類比輸出並且空載時。輸出電壓的部分，在兩端皆是high duty cycle時，兩端最高電壓幾乎只落差0.多Volt但兩端到medium duty cycle時，兩端最高電壓已落差1.多Volt。波形的部分，幾近一致，但頻率兩端無論是甚麼duty cycle，頻率落差將近兩倍，一端470Hz，另一端900Hz，推測將會影響馬達扭力，因為單位時間馬達獲得能量不一。 
        
        * ENA,ENB=200;
        ![](https://i.imgur.com/9g1vr3L.jpg)
            ![](https://i.imgur.com/esPyHav.jpg)
        * ENA,ENB=120;
        ![](https://i.imgur.com/E1IFvw1.jpg)
            ![](https://i.imgur.com/SbKK0DR.jpg)



* 組內討論事項 (必填)
    * 紅外線控制
        * 未來我們打算用遙控器來控制車車的行徑方向，下圖為我們未來要使用的遙控器。 
        * 吉鈞撿破爛來的
        ![](https://i.imgur.com/NRcxobX.jpg)
        
    * 天馬行空：
        * 期末專題有齊想做電磁砲
        * 我沒有說喔ＸＤ　giri　
        * 咦沒嗎 yo chi 說的ㄟ
        * 是沒啦，我其實是說我學長MakeNTU要做的
        * 蛤 giri
        * 蛤 xavier
        * 乾兩個人一起打超當，我以為我打完了 giri
        * 所以到底要天馬行空什麼... by xavier

 
* 組員分工 (必填)
    * 有齊: 修改程式，測量電壓，協助拍照。
    

    * 吉鈞: 連接藍芽，使用示波器測量L298N，工作紀錄簿。
    ![](https://i.imgur.com/41uIFcd.jpg)



    * 彥宇: 操作示波器，拍照記錄，工作紀錄簿。




* 遇到的問題、處理狀況、解決方式 (必填)
    * 找出兩邊動力不相等的問題
        * 如何發現？
            * 最一開始吉鈞在輪子上面貼白色膠帶發現了在相同PWM輸出的情況下，右輪會明顯慢很多。
            ![](https://i.imgur.com/fY0fPTK.jpg)

            * 吉鈞很氣
                 ![](https://i.imgur.com/YAGUPhu.jpg)
                [ #吉鈞很氣](https://i.imgur.com/YAGUPhu.jpg)

        * 馬達的問題？
            * 我們用電源供應器給定兩顆馬達一樣的電壓，發現其實兩顆馬達多少有轉速上的不一致。
        * L298N?
            * 最後我們測量了L298N在不同電壓下輸出的波形圖，發現兩邊電壓有不一致的情形。
            * 說明礙於篇幅，請參實際達成事項
            * 但其實我們不太敢斷定是L298N的問題，原因其一，我們無法確定示波器的平均電壓是如何平均的，以及頻率的計算方式，原因其二，我們也無法確定這些因素將會對馬達造成甚麼影響。
           
* 課程建議 (選填)

* 想說的話 (選填)



## 第五週紀錄 週六(4/4) 自行組裝紀錄
* 預計完成事項
    * 穩定車車的軌跡，延續上次OpenLab沒完成的工作、運用尋跡傳感器讓車車能夠沿著地上的黑線行走。
    * 找出左右輪的電壓與轉速關係
    * 下圖是最簡易版的線路(用黑色海報紙製作)，用來測試傳感器功能和程式是否正確。
    ![](https://i.imgur.com/BiEhCgc.jpg)


* 實際達成事項（必填）
    * 測出讓兩邊輪子保持相同速度旋轉所需的兩側電壓差
       * 下圖為我們在測試時的其中一部份紀錄，r+代表增加右輪電壓(最大255)、l+代表增加左輪電壓、r-、l-依此類推，s代表停止。
       ![](https://i.imgur.com/cgORET8.png)
       * 最後測出來的數值：在較低電壓時(約60至100)，右輪需較左輪多15~20單位，而在較大電壓時兩者相差不大。

    * 成功讓車車順著直線轉彎
    ![](https://i.imgur.com/st5dIIV.gif)
    (我也要玩gif~ by Xavier)





    
    * 寫出讓車車感測軌跡並轉彎的演算法
      * 演算法介紹：車頭有六個傳感器，我們將有感測到黑線的傳感器標成1，剩下的標成0，接著將不可能的項目去除(例如100001、110010等)，接著把這個碼換成十進位，存成一個參數，最後再依據這個參數的值判斷車車當下應該要左轉還是右轉。
      * 一開始我們只用三個傳感器，僅粗略的判斷線的位置
      ![](https://i.imgur.com/NWKgUcI.jpg)
    
      *  這是四顆傳感器的示意圖
      ![](https://i.imgur.com/x7LK6sO.jpg)
    
      * 下圖為我們正式使用的6顆傳感器的示意圖，經過對不可能的情況的排除，最後會只剩下17組狀況，再經過編碼(例如110000為caes 48)，就構成今天我們寫出演算法的核心。
      ![](https://i.imgur.com/4KTwX1R.jpg)
    
      * 演算法參考來源：https://yunlinsong.blogspot.com/2016/12/mblock.html
     
    * 程式碼(20200404資料夾)：https://drive.google.com/open?id=1vIihFpJ35WSFW8Sm9WDAOVhNA7ztv5Jp
        
        * motor_test_0404：
            * 用一個英文字母控制車子的版本
            * 不太好用因為常常會忘記速度加到哪
        * motor_test_0404_1：
            * 用類似指令碼的概念控制
            * 例如：r+080表示右輪電壓設為80
            * 支援負數輸入
        * trace_test_1：
            * 在完全沒有頭緒的情況下寫的
            * 完全沒用
        * trace_test_2：
            * 上網查了一下後參考(https://yunlinsong.blogspot.com/2016/12/mblock.html)寫出來的
            * 可以正常循跡
            * 我自己加上紀錄last_dir功能後性能變得更好(可見組內討論事項/改良演算法)

    * 成功讓車車沿著圓形軌道(應該勉強算圓的)繞行一圈以上
    https://www.youtube.com/watch?v=b9ZFmrDVar4
    這個是比較低速、基礎的版本，之後的修正跟魔改放在下面。
* 組內討論事項 (必填)
   * 改良演算法
      * 車車的速度過慢的話，轉彎的時候可能會因為扭力不夠而停下。(原因待查明)
        https://www.youtube.com/watch?v=ZAYJ_WDMX-k

      * 因為車車常常跑過頭，然後當時程式只要偵測到全白就會停下，所以被我媽說：「好弱喔」
        ![](https://i.imgur.com/a9WOxea.gif)


      * 所以決定不要讓車子擺爛
      * 方法：
         * 建立變數last_dir
         * 每次偵測時只要不是000000，就把測到的值存入last_dir
         * 如果偵測到000000，就改成回傳last_dir
         * 就醬而已
             ![](https://i.imgur.com/OGQAzSR.png)

      * 結果這三行程式讓車子從迷路模式變成藤原拓海模式⋯⋯

     * 成果
       * 迷路模式（舊程式）
       ![](https://i.imgur.com/Hj0NSay.gif)

       * 藤原拓海模式（增加記憶功能）
       用手擊打行走中的車車：
       https://www.youtube.com/watch?v=k3HGX8Yi08k
       加快車速(真正的藤原拓海)：
       https://www.youtube.com/watch?v=Xz_0i0bSH0g
       
       * 德布羅意模式（換回課程發的萬向輪）
           https://youtu.be/Udcx3JYMSRM
 
* 組員分工 (必填)
    * 有齊:　程式修改、操縱車車、演算法思考和撰寫
    * 吉鈞:　在HackMD上講幹話 & 遠端討論(真是謝囉 by Giri)、工作紀錄簿
    * 彥宇:　工作紀錄簿、操控車車、拍影片、幫助Yo Chi一起思考演算法、跟Giri在HackMD上講幹話

* 遇到的問題、處理狀況、解決方式 (必填)
    * 跑太快，在尋跡的時候會衝出軌道，或在過窄的彎會彎不過去。
        * 降低速度：
            * 但是這麼做可能會讓馬達突然動不了
            * 而且看起來很遜
        * 修改一下演算法：
            * 原本的狀況是如果車車沒有感測到黑線就不會有動作，現在改成只要感應到全白，會叫出上一次不是全白的情況，讓車子變成有暫時記憶軌跡的能力，即使轉過頭偏離航線時也可以把自己拉回來。
        * 萬向輪：
            * 由於上週發現難以直行是因為馬達而非萬向輪的問題，所以我把原本發的萬向輪裝回來，不過還是發現它會讓車子搖擺變大，所以還是不如球形萬向輪。
        
    * 在嘗試藍芽遙控車的時候，會無法雙向通訊。
        * 目前也只能把接收跟輸出分成兩份程式碼執行，不過詢問後得知似乎把藍芽的腳位改成非pin1,pin0似乎可能可以解決問題。

    * 在遙控車車使它不斷往右或往左時，車車會有其中一輪在停止後突然往反方向暴衝。
        * 因為我們在轉彎時讓輪子變慢的方法是減少enable，但enable的值只能在0~255，所以當enable被減到小於0時，就會發生溢位然後暴走。
        * 所以我們在enable上加上限制，讓他在要被減到負數時停止，並切換enable的low跟high，這樣就不會有剛剛溢位的問題了!
   

* 課程建議 (選填)

* 想說的話 (選填)
    * 彥宇：完成車車要從有一顆好的肝開始。
    


## 第五週批閱區
* 助教批閱欄
* 教授批閱欄
    * 教授評分等第
    
    * 教授回饋



## 第六週紀錄（週四 4/9）
* 課堂應完成事項(**下課前必須找助教檢查**)
    * 完成讓車車尋跡，並完整跑完橢圓軌道至少兩次。
    * (選作)讓車車走過第二張髮夾彎圖紙。

* 實際達成事項（必填）
    * 讓車車在橢圓形軌道上跑至少兩圈。
    影片網址：https://www.youtube.com/watch?v=I3s72D8BUm8
    
    * (選作)讓車車走過第二張髮夾彎圖紙
    影片網址：https://www.youtube.com/watch?v=C7Spwj2Vkjg
      * 我們在髮夾彎的圖紙上最高能以（160，170）的電壓行進。在我新增「短期路徑記憶」的功能之前，我們在家裡以（65，80）走一個大橢圓都難以走完兩圈，可見好的演算法的重要性。

    * 程式碼(資料夾20200409)：https://drive.google.com/open?id=1hdfJrqgUNuIlbRoKeEs2BNjdnHibn0Nq
    
        * trace_test_3：
            * 大體上和trace_test_2相同
            * 把紅外線的臨界值調降到50
            * 增加了2,4,8,16這四個我們原本沒考慮到的紅外線偵測組合(也就是只有一個紅外線偵測到的情況)
            * 嘗試要做一正轉一反轉，但是沒有成功
        * trace_test_4：
            * 為求簡潔，把紅外線偵測的情況減少到0,1,2,3,4,6,8,12,16,24,32,48(助教發的地圖的所有可能情況)
            * 暫時不嘗試反轉，當一邊速度小於0，則直接回傳0給L298N，避免溢位
        * trace_test_5：
            * 增加在轉彎時減速的功能
            * 支援反轉(把車子拿起來時有反轉，但實際跑的時候速度很快所以很不明顯)
            * 速度已經可以到兩邊電壓(115,130)
        * trace_test_6：
            * 增加直線加速功能：若黑線一直在中間的紅外線感測模組附近累積超過200ms，電壓+30
            * 可以跑到兩邊電壓(170,180)
            * 而且是bonus地圖


* 組內討論事項 (必填)
    * 針對軌車尋跡性的優化
        * 目前的程式碼還是沿用上周的模板，也就是分情況討論。
        * 我們打算新增一個時間函數，每隔一段固定時間取一次紅外線傳感器的數據(例如：000010，000001等等)，看看同一種模式持續多久，(例如000001只出現了1~2個clk，可以推測是在wobbling，而如果持續了5個clk以上，可以推斷是在經歷急轉彎。)進而衡量出每一時刻軌道的曲率半徑，並依此數據來調整車車的轉彎車速，去fit該軌道狀況。
        * 其實就是類似PID啦。
        * QUESTION:其實不太確定這算不算是D control????
    * 非定速行駛
        * 轉彎相對直行本較難控制，因此我們設計在車車判斷是直走的時候就加速到一定值，然後在判斷是轉彎的時候就減速，關於這個點，如果有能偵測輪子轉速的sensor，例如LM393 光電對射式計數器模組，就能在近一步實施對輪子轉速的PID control，讓從彎道進直道能均勻加速，直道進彎道可以均勻減速。這樣就可以避免因為車車一路都是以固定低速行走，可以降低走完一圈的時間，並降低脫軌機率。
    * 在過彎速度快時可以增加甩尾的功能
        * 我們仍然希望能提高在轉彎時的車速
        * 這是從Yo Chi寫急轉彎的function得到的靈感
        * 如果在過彎時鎖死一顆輪子以及前方萬向輪，過彎可以漂移
        * 其實我們發現用甩得過彎，絕對會比沿著黑線循跡快得多
        * 暫時的想法: 可以把萬象輪的鋼珠改成球形鐵珠，上面換成電磁鐵，當遇到大轉彎時，就通電將萬象輪用磁力鎖住，就可以達成甩尾的功能。

    * 利用機器學習找出控制函式的可行性：
        * 如果要讓電腦跑大量數據，那麼勢必要使用電腦模擬，但是車子的馬達十分不穩定，難以正確模擬。
        * 就算能正確描述車子的移動，要如何定義「好的轉彎」或「好的直走」（也就是如何描述成本函數）？
 
* 組員分工 (必填)
    * 有齊:　修改程式碼、找尋舊的演算法裡面的bug、工作紀錄簿
    ![](https://i.imgur.com/atRN7eY.jpg) 
    (有齊大神!!!)
    ![](https://i.imgur.com/wy8s41X.gif)


    * 吉鈞:　檢查程式碼、想新的演算法(循跡性的優化)、工作紀錄簿


    * 彥宇:　檢查程式碼、工作紀錄簿、影片




* 遇到的問題、處理狀況、解決方式 (必填)
    * 一開始放上軌道車車無法正確循跡
        * 紅外線的問題
           * 我們自行測試時用的軌道較黑，所以把紅外線感應模組的臨界值調到200，後來我用Serial檢查後發現地圖的反射率更高，所以可在100左右就算是偵測到黑線，因此我將臨界值調到50。
        * 程式的問題
           * 因為上次假日自己實作的時候鋪的軌道較粗（至少兩個sensor以上），所以沒有列舉到只有一個感應器亮的情況(例如：001000、000010等)，就會導致今天將車車放上軌道的時候因為沒有寫入這種case導致車子沒有反應。
           * 所以我們補加上這六個case。
       
    * 有時候使用一樣的程式碼左輪會動不了，有時候右輪會動不了。
        * 觀察1: 只要車車沒有放在地上，過很久都不會出現其中一輪不轉的狀況。
        * 觀察2: 發生這種情況都無一定週期與規律
        * (Yo Chi's statement)推測可能是部分程式碼判斷寫錯，或是delay調太短導致馬達扭力不夠，也有可能是硬體問題(這部分機率不大，因為上次我們自己測試的時候並沒有這個現象)。
        * (Giri's statement)其實車子剛組裝完就有發現這個問題，當時主要在測試左右轉馬達所需EN時，只是單純讓車子一直右轉，就會有右輪忽然停住的狀況，所以個人認為可以排除軟體部份的問題。
        * (Xavier's statement)在第一次寫出演算法並實際測試的時候就有這個現象，詳見上週工作紀錄簿。但根據後來幾次的測試，在加大轉速到約60~80以上後就不太會有這個現象，也因此我們需要根據這個結果調整出能夠讓車車在較高速速度下吻動行走跟轉彎的演算法。
        * 解決辦法:
          1.   只要把車子稍微抬高，便可以恢復原速。
          2.   可能可以在車輪加裝霍爾感應模組，直接測車輪轉速並採用封閉迴路的控制。
          3.   或是在馬達上改裝齒輪組增加扭力，但這牽涉到車體結構的變更，可能未來才能做改善。

* 課程建議 (選填)
    * 可以考慮一下加裝齒輪組，這樣可以讓車子在低速穩定行駛

* 想說的話 (選填)
    * 吉鈞: 好的心情從擁有一顆好馬達開始。    [#吉鈞很氣](https://i.imgur.com/YAGUPhu.jpg)
    * 有齊：感謝助教跟教授們對我們工作紀錄簿的鼓勵，其實一開始只是單純覺得好像可以留給學弟妹作參考，希望他們不要走我們走過的冤枉路，今後我們也會盡量詳實紀錄我們遇到的問題和思路。
    * 彥宇：最近發現自己打字速度有顯著提升...

    
## 第六週自行組裝紀錄(週三4/15)
* 預計完成事項
    * 完成課程指定任務
    * 將各函式封裝成class

* 實際達成事項（必填）
    * 完成課程指定任務
        * Code
            * https://drive.google.com/open?id=1vIihFpJ35WSFW8Sm9WDAOVhNA7ztv5Jp
            * 20200415/有齊的/system_integration_1
        * 指令表
            * r
                * 微右轉(200ms)
            * l
                * 微左轉(200ms)
            * f
                * 微前進(200ms)
            * b
                * 微後退(200ms)
            * R+XXX
                * 直接設定右輪速度
                * 範例：
                    * 'R+100'：設定右輪ENR的電壓為100
                    * 'R-100'：設定右輪反轉，電壓100
                
            * L+XXX
                * 直接設定左輪速度
                * 範例：
                    * 'L+100'：設定左輪的電壓為100
                    * 'L-100'：設定左輪反轉，電壓100
            * F
                * 設定兩輪直走速度
                * 範例：
                    * 'F+100'：右輪115，左輪100(15為兩輪速度差)

            * t
                * 循跡模式
                * 進入循跡模式後，用F+XXX指令給速度
            * s
                * 停車
                * 若在循跡模式使用's'，則會停車並離開循跡模式。
        * 影片 https://www.youtube.com/watch?v=3pZbGZhJxpU


    * 封裝(OOP)
        * Arduino OOP 測試：
            * path：20200415/有齊的/OOP_test_1
            * 成功讓LED照指令閃爍
        
        * 完成Basic_Control跟Wheel兩個class，但是還沒有實際上傳板子測試
           * Wheel:
             ```C++
             class Wheel{
                Wheel(byte pin_EN, byte pin_IN1, byte pin_IN2)
                void forward(bool);
                void set_speed(int);
             };
             ```
           * Basic_Control:
             ```C++
             class Basic_Control{
               void set_speed_r(int spd);
               void set_speed_l(int spd);
               void set_speed_s(int spd);
               void stop();
               void run();
             };
             ```
 

* 組內討論事項 (必填)
    * OOP
        * 由於程式越來越複雜，我們在討論使用OOP
        * 目前規劃將各種功能寫成不同class：
            * Tracking：循跡
            * Control：直接遙控
            * Bluetooth：通訊
            * Maze：走迷宮
        * 參考資料：
            * https://youtu.be/o0zxcLgQUn0
    * PID control
        * 參考資料：
            * Ziegler–Nichols Method
            https://zh.wikipedia.org/wiki/%E9%BD%90%E6%A0%BC%E5%8B%92%EF%BC%8D%E5%B0%BC%E7%A7%91%E5%B0%94%E6%96%AF%E6%96%B9%E6%B3%95
            * 別人實作的論文：
                 https://core.ac.uk/download/pdf/82186214.pdf
        * 打算採取的策略：
            * 先實作P Control
            * 然後試著使用 Ziegler–Nichols Method 找出I跟D部分的參數
        * 討論：
            * error要直接用analog的值還是先換成0,1
                * 有齊：用digital可以避免在不同路上跑的情況不同
                * 吉鈞：用analog微分積分比較連續
 
* 組員分工 (必填)
    * 有齊:碼農(OOP)　(什麼是碼農?)


    * 吉鈞:操控車車、研究實作PID的方法　


    * 彥宇:碼農(遙控控制)，錄影　




* 遇到的問題、處理狀況、解決方式 (必填)
    * 彥宇的電腦沒辦法上傳給Arduino
    (我猜可能是路徑或資料夾的問題，目前繼續嘗試中 by Xavier)
        * 用有齊的電腦上傳
        * 基本上：
            * 有齊的電腦：Arduino OK，藍芽 不OK
            * 彥宇的電腦：Arduino 不OK，藍芽 OK
            * 吉鈞的電腦：Arduino 以前不OK現在OK，藍芽 OK
            ![](https://i.imgur.com/oTsjkM4.gif)
   

* 課程建議 (選填)
    * 我覺得可以教一下Arduino的OOP，因為把程式整理好還蠻重要的，不然不同功能可能會打架。

* 想說的話 (選填)
    * 彥宇：想問一下助教在做車車的時候是不是都在當肝帝啊?畢竟這門課想要把車車做到極致所花的時間也是很多的，不知道助教們之前平均會花多少時間在這門課上呢?

## 第六週批閱區
* 助教批閱欄
    * 不愧是紀錄簿範本，又是屌電其他組XD arduino的oop架構和C++的相同，這應該是計算機程式cover到的範圍（？
    * 看完你們整個循跡演算法最有印象的應該是偵測到全白就回傳last_dir的部分，藤原拓海模式真的有夠強，媽媽的一句「很弱」威力太強大ㄌ。另外有看到你們除了ppt上的PID control還有上網查其他的循跡演算法，很棒！
    * 阿對remote mode的指令也寫得很好
    * 至於當肝帝的部分呢，其實你們這屆是第一屆開始變成等第制，以前這門課其實只有pass and fail，所以今年loading是真的有變重，但在最後final project的時候就部會那麼累，我們有移一點loading到前面，我當年在修的時候在最後專題前還待在open lab通宵過兩個晚上，因為de硬體的bug真的很花時間
    * [name=Yen]
* 教授批閱欄
    * 教授評分等第
    
    * 教授回饋
    
    
## 第七週紀錄
* 主題：指定題宣布
* 課堂應完成事項(**下課前必須找助教檢查**)
    * 問題0回答、答案訂正
    * 問題1回答、答案訂正
    * 問題2回答、答案訂正
    * 問題3回答、答案訂正
    * 完成甘特圖
    * 完成系統方塊圖
    > [name=yen]

* 實際達成事項（必填）
    * 回答投影片問題
        * 問題0 - 馬達功率：
            * P=IV = 0.180(A) * 6(V) = 1.08(W) 
        
        * 問題1-1 - 尋寶車功率：
            |模組名稱| 數量 | 模組功率 |
            |-----| -------- | -------- | 
            |Arduino Uno| 1     | 200mW   |
            |Bluetooth| 1     | 33mW    |
            |RFID| 1     | 86mW   |
            |Motor| 2    | 1080mW  |
            |IR_sensor| 6 | 75mW |
            || total| 2929mW    |
            
        * 問題1-2 - 電池電流：
            * 2929mW/11.1V=263.87mA
            
        * 問題1-3 - 供電時間：
            * 2250mAh/263.87mA=8.5h
            
        * 問題2-1 - 地圖本身所需記憶體容量
            * 一個node：2*(4+4) = 16B (不考慮node名稱，用順序替代)
            * 16*150 = 2400B
            
        * 問題2-2 - 執行BFS演算法，所需最大額外暫存容量?
            * 2*(100+150+150) = 800B
            * 100個 queue
            * 150個 mark 跟 distance
            * 至於我們是怎麼算出100個queue的呢...?
            ![](https://i.imgur.com/tJxsw78.jpg)

            我們計算出現最多queue的情況是把node分成上中下三排，車車從中間走過的情況，每次車車走到新的node，totoal queue會+3並-1。
            例如車車從A開始，queue有B、C、D，接著走到D，queue裡有B、C、~~D~~、E、F、G，依此類推，總共有 4+(50-2)*(3-1) = 100個
        * 問題2-3 - 地圖跟BFS演算法，可否放入Arduino中?
            * 2400B + 800B = 3200B > 2048B
            * 放不下
            
        * 問題3-1 - 需要多少通訊速率(bits/sec)?
            * 看到轉彎塊：上傳1byte字元作為訊號
            * 看到RFID UID：上傳4bytes(8個字元或4個16進位整數)
            * 接收後續指令：下載1byte字元作為後續動作指令碼
            * 總共需要：1+4+1 = 6bytes/0.1sec = 60bytes/sec = 480bits/sec
            
        * 問題3-2 - 藍芽是否可支持此通訊速率?
            * 9600bits/sec > 480bits/sec
            * 可以支援此通訊速率。
            
    * 本組甘特圖
     ![](https://i.imgur.com/PBfjSiE.png)


     [點我放大](https://i.imgur.com/PBfjSiE.png)


 

* 組內討論事項 (必填)
 
* 組員分工 (必填)
    * 有齊: 演算法、課程問題討論、計畫甘特圖項目及時程、上台回答問題


    * 吉鈞: 課程問題討論、工作紀錄簿、甘特圖美編(ft.台大簡報課)、上台回答問題 
    
        (我覺得那個icon超讚的 by Xavier)


    * 彥宇: 課程問題討論、工作紀錄簿、計畫甘特圖項目、上台回答問題、遲到 
        
        (嗚嗚我就爛...)



* 遇到的問題、處理狀況、解決方式 (必填)
   

* 課程建議 (選填)

* 想說的話 (選填)


## 第七週批閱區
* 助教批閱欄
    
    
* 教授批閱欄
    * 教授評分等第 A+
    
    * 教授回饋
-由於第六週有課後影片上傳的部份，所以和第七週一起回覆、給分
-上課時間及課後實作都有完整記錄，這點很棒
-這大概是我帶這門課三年以來看到最能處理出軌狀況的彎道循跡，期待你們迷宮的表現
-你們打算新增的時間函數應該算是 D control 的某種變形，可以試試。
-循跡時若地圖比較複雜，有時會遇到特殊的例外，例如全黑(軌道直角轉彎)、左右黑中間白(讀到兩條軌道或U型轉彎)等等，迷宮的轉角也可能會造成奇怪的狀況，可以想想要怎麼處理。
-其實這門課沒有想要求大家把車車做到極致，往年只要慢慢穩定的走，比賽時成績就會前幾名了。

-Ho-Lin


## 第八週自行組裝紀錄
* 預計完成事項
    * 改Arduino腳位
    * 測試藍牙傳輸

* 實際達成事項（必填）
    * Arduino腳位紀錄

        | 功能 | 腳位 |備註|
        | -------- | -------- |----|
        | ENL     | 3   |
        | ENR|6|
        |RFID_RST|0|brown
        |RFID_MOSI|11|
        |RFID_MISO|12|
        |RFID_SCK|13|
        |IR|A0-A5|
        |IN1|8|right
        |IN2|7|right
        |IN3|5|left
        |IN4|4|left
        |bluetooth TX|2|yellow
        |bluetooth RX|9|green
    
    * 測試完成藍芽雙向傳輸
        * https://drive.google.com/open?id=1vIihFpJ35WSFW8Sm9WDAOVhNA7ztv5Jp
        * /專題/src_1/ (argv[1] = 3)
        * 這個版本可以讓車車傳掃到的RFID給電腦
    
    * 測試BFS、Maze
        * /專題/src_2/ (argv[1] = 2)
        * 可以正確的把csv檔裡面的資料傳進node
        * 可以正確的給出任兩點的最短走法
        * 測試：
            * 測資：由於課堂上發的地圖~~太沒挑戰性~~沒有loop，所以借用了一下于天立老師計算機概論的圖：![](https://i.imgur.com/l44XKjv.jpg)

            * 再自己把它打成鄰接表(因為我目前只處理路徑，所以東西南北完全不必管)![](https://i.imgur.com/TA8dBZ8.png)

            * 測試結果![](https://i.imgur.com/PpW2WN5.jpg)
                (第一筆測資走的是1->5，第二筆是5->4)

* 遇到的問題
    * 看不懂程式碼QQ
        * 我們這組沒有人會python
        * 所以只好找其他組的python大神合作-->子濬&郁翔
        * 基本上我先看懂函數跟類別的功能，再請他們翻譯成python語言
    * 藍芽的傳輸不太穩定
        * 假設UID = 12345678
        * 正常情況下藍芽回傳到電腦應該是：
            ```
            id[0] = 0x12
            id[1] = 0x34
            id[2] = 0x56
            id[3] = 0x78      
            ```
        * 但是偶爾會：
            ```
            id[0] = 0x1234
            id[1] = 0x56
            id[2] = 0x78
            id[3] = 0xa      
            ```
        * 把BT.py裡面的參數調整一下可以改善：
            ```python=
             def SerialReadByte(self):
                sleep(0.05) #把0.05改成0.01甚至0就可以改善
                waiting = self.ser.inWaiting()
                rv = self.ser.read(waiting)
                if(rv):
                    UID = hex(int.from_bytes(rv, byteorder='big', signed=False))
                    self.ser.flushInput()
                    return UID
                else:
                    return 0
            ```
        * 但是考量到那個`sleep()`可能有其作用，我暫時不敢改
                
            
    




## 第九週紀錄
* 主題：指定題設計、製作、進度報告
* 預計完成事項 (必填)
    * 測試出左轉及右轉參數。
    * 理解arduino程式內容並完成search_mode、set_state函式，並添加turn_state函式。
    * 討論出遇到節點node時的轉彎方式。
* 實際達成事項 (必填)
    * 測試出右轉參數。
        * 依照這個模式可以順利地進行90度的直角轉彎：
            

        | 轉向 | 左右輪 | PWM | 持續時間 |
        | -------- | -------- | -------- | -------- |
        | 右轉    | 左輪     | 145     | delay(100)     |
        |        | 右輪     | -60     |                |
        | 左轉    | 左輪     |         |                |
        |        | 右輪     |         |                |
        | 迴轉    | 左輪     |         |                |
        |        | 右輪     |         |                |
    * 理解完arduino程式內容。
        * 我們另外加了兩個以前用的class：Wheel 跟 IR_array
        * 單純只是我們懶得重寫而已
        * 今天修改了IR_array的函數，可以回傳較多種可能，以支援更多判斷
    * 討論出兩種轉彎方式。
        * 我們目前嘗試使用比較激進的轉彎策略
        * 但是我們一樣會做保險的版本，兩次嘗試中可以分別挑戰
    * 完成部分search_mode函數。
        * 把修改過後的IR_array加進去，之後會再加上循跡功能
* 組內討論事項 (必填)
    * 是否需要針對得分函數取最佳化並依此來設計演算法：
        * 我們一開始想說每次都找最近的沒走過的點，應該就可以，不過考慮到這種狀況：![](https://i.imgur.com/lVAQppQ.jpg)

        * 那麼硬爆呢？
            * BFS至少需要O(n)的時間複雜度，我們要BFS完 n*n 個組合，所以大概要 n^3的時間複雜度
            * 但是要把各種路徑都試過，至少要n!的複雜度
            * 基本上不太可能

        * 後來上網查了traveling salesman 問題，發現這個問題似乎很難
        * 所以要再想想......
        * 吉鈞：
            * 區塊切割，這樣就可以對一小團硬爆
            * 如果一團只有四個點，那麼只需要24次就可以算完，就算用到6個點，也只需要720次。
            * 所以可能會先選一塊拿保險分，選一塊看剩下多少時間拚拚看

    * 可以先在電腦上利用演算法計算車車後續的移動步驟，並將這串成指令發送給車車，讓車車不需要走到節點的時候才向電腦詢問接下來的步驟，可以很順暢的連續執行動作。
* 組員分工 (必填)
    * 有齊:　python程式、arduino程式、演算法程式碼、系統整併、工作紀錄簿


    * 吉鈞:　arduino程式、轉彎參數測試、打出turn_mode函數、工作紀錄簿


    * 彥宇:　arduino程式、合併之前的循跡函數、打出search_mode函數、工作紀錄簿

* 遇到的問題、處理狀況、解決方式 (必填)
    * 關於車車在節點的轉彎行為，我們想出了兩種轉彎方法，一種較為保守、另一種比較冒險。
    * 保守作法：當車車遇到節點的時候(五至六顆感應器為黑)，就結束循跡模式並直走到節點結束為止(感應器全黑狀況結束)，並且在原地做90度的直角轉彎，接著再直走到節點結束，然後開啟循跡模式繼續走。
        遇到端點狀況亦同：結束循跡模式並直走到節點結束後，在原地轉180度，再開啟循跡模式。
        * 優點：軌跡穩定，較不容易出軌。
        * 缺點：因為在轉彎時動作不是連續的(不是邊前進邊轉彎，而是先移動到位後再原地旋轉)，所以會導致多餘的時間消耗。 
    * 另一種我們想的轉法：在進入節點時便取消循跡模式，並開始按照設定好的參數模板轉彎，讓車車邊前進邊進行轉彎，並且在這期間完全不依靠感測器的數據(以下簡稱盲轉)。當轉彎完成後，感測器不在是全黑時，再切換成循跡模式並繼續行走。
        遇到端點時就變化不大，一樣是讓車車原地迴轉。而當感應器全黑時，該點是否為端點則是交由控制電腦來判斷，並發送指令給車車。
        * 優點：轉彎動作是連續的，因此可以節省執行分解動作時所耗費的時間。
        * 缺點：因為沒有停下車車來穩定它的位置，所以可能會導致失控出軌。同時，需要精確的數據做為轉彎時的依靠基礎，而且還不能保證每次轉出來的結果會一樣，穩定性不高。

    * 但是，我們貪心的想兼容兩者優點，卻又不想承擔兩者的缺點，於是...

        * 解決方式：
             * 其一：量測出轉彎的固定模板數據(詳見今日實際達成事項)，並按照這個模板做接下來的動作，但是，這樣還是有可能會因為車體晃動而出軌，所以我們找了另一個想法。
             * 其二：判斷當六顆感測不是5~6顆感測到黑，那就開啟循跡模式，利用循跡模式中之前提的"記憶前一步動作"(aka藤原拓海模式)功能把車車從軌道外拉回來；反之則保持在自動轉彎模式，直到轉完為止。
         
             * 以上解決方式皆為目前討論出的想法，實作後若有問題會再補上。
* 課程建議 (選填)
    * 有齊：雖然我很認同讓我們自己看懂程式碼在寫什麼是很重要的訓練過程，但是我覺得可以在城市裏面多加一些註解，畢竟每個人的架構都會不太一樣，如果有多一點說明會讓我們比較快理解助教所設計的架構。

* 想說的話 (選填)
    * 有齊：我覺得最後的討論階段蠻有意義的，可以就碰到的困難進行交流，幫助一些組別解決問題，不過我個人希望還是不要太早公開還在研發中進階概念，倒不是因為擔心會被洩漏(如果有人問我們，我們基本上都會跟他們解釋我們的構想)，只是我擔心這樣會讓原本進度就落後的組別陷入更大的焦慮。另外我們也不能保證這些構想的可行性，如果造成大家無謂的投入好像也不大好(´･_･`)






    * 第995行
    * 第996行
    * 第997行
    * 第998行
    * 第999行
    * 第1000行
        ![](https://i.imgur.com/oPmJZfD.png)

## 第九週批閱區
* 助教批閱欄
    * 助教回饋
    <font color=blue>
    * 首先對於程式碼問題的部分，如果覺得註解你還是看不懂的話，可以直接去問助教沒有關係，也省下很多你自己在那邊煩惱的時間。就算不是當初寫這份code的助教，畢竟也都有做過一次，都會知道大概的架構在做些甚麼。還有偷偷工商一下現在FB社團有一篇關於code的討論文章，有任何問題都可以去爬文/留言。
    * 再來是轉彎的部分，能不能真的順利且穩定真的需要多次嘗試。不過提醒一下在端點迴轉前，還需要獨到RFID的卡號。需要考慮在都不停的情況下能否順利及時的讀出卡號，才能回傳給電腦拿到分數。最後演算法的部分，可以先寫出一個最笨的方法至少讓整個程式架構能夠動起來，再去思考要如何優化，我自己覺得對於整體的測試會比較有幫助。
    </font>
    > [name=erik]

* 教授批閱欄
    * 教授評分等第
    A+
    * 教授回饋
    1. 我剛剛去查，你們組名每個字要怎麼念.....  >_<
    2. 八九兩週我都一起看完了，沒有人會 Python 沒關係，正好可以透過這時間練一下 (逃~) 
    3. 如果程式碼有問題，除了找別組同學討論，可以也可以在上課時間直接找助教請教。
    4. 至於公開研發中進階概念這事，有齊很貼心怕造成別人壓力，我覺得您這樣很好；其實個人建議可評估，如果覺得可能可行，但短時間卻又沒想到適合的解法，告訴大家這些都還是發想階段，有興趣可以一起研究討論 (讓大家都變好)，是我自己會採用的方式。當然，不能保證沒有人偷學後，他很快做另一套然後不告訴您，這可能性的確存在 (至少認清了一位同學)。
    5. 另外自己的經驗是，如果有很高信心滿足課程要求，或對結果比較有把握後，這時在不給程式(提供詳細觀念與做法)下普照大家，都是您們可以參考的做法。
    > [name=Jiun-Peng]


## 第十週紀錄
* 主題：指定題設計、製作、進度報告
* 預計完成事項 (必填)
    * python code
    * 調整tracking 參數
    * 調整轉彎參數
    * 設計好 **轉彎 / 迴轉 / 直行**的流程
* 實際達成事項 (必填)
    * python code:
      * 目前已經完成了**maze,bluetooth部分**的函數
      * 目前還要處理**路線規劃、轉換路線成指令列、上傳指令列**，這些完成應該就可以了
    * 函數整理表：https://hackmd.io/@ba144220/ry8Vv0ctU/edit
* 組內討論事項 (必填)
    * 要不要換回原本的萬向輪？
       * 之前會換萬向輪是因為在急轉的時候，球型萬向輪比較好
       * 但是現在大多是直線，而且球型萬向輪有時候會卡住
    * 激進版的開發：
       * 由於激進版實在是很危險，我們覺得平行開發激進版和保守版
       * 目前吉鈞負責激進版，有齊跟彥宇負責保守版
* 組員分工 (必填)
    * 有齊 : python code (最難的部分...)


    * 吉鈞 : arduino code 轉彎參數測量(激進版)、


    * 彥宇 : arduino code、irArray 調整、編輯函數整理表(yochi創的)

* 遇到的問題、處理狀況、解決方式 (必填)
    * 我不會python
      * 說明
        * 我們三個都是修C++
        * 我不太熟悉python的一些基本技巧像是dictionary等
        * 而且我python寫得很C++
      * 解決方式
        * 跟其他組會寫python的人合作
        * 請他們幫我翻譯成python
    * 左輪馬達瘸了
      * 說明
        * 之前左輪馬達都會比右輪轉的快
        * 但今天轉的很慢
        * 而且轉了一段時間之後燙燙的
        * 
      * 解決方式
        * 我們後來試了另一顆新馬達，問題就解決了
        * 而且用了新馬達之後，兩輪等速的電壓差跟以前還是一樣
    * 轉彎的控制方式
      * 說明
        * 我們發現，比起使用計時控制，當紅外線偵測線時停止轉彎是比較好的做法
        * 但是如果當要開始轉彎時前方有線，會造成車子以為它轉好了
        * 有些組是直接先計一小段時間，再開始判斷
        * 我打算如果轉彎之初有偵測到線，那麼它會先轉過那條線再判斷
        * 不過不知道為什麼它就是沒辦法這麼做，可能我要再檢查一下code
       
* 課程建議 (選填)
  

* 想說的話 (選填)

* 助教批閱欄
    * 助教回饋
    <font color=blue>
    * 轉彎用偵測的的確是一個好方法，但是其中還是有很多細節需要注意，特別是車車進入node之後，有沒有要往前再轉彎、轉彎前車車是不是有機會看到不該看到的黑色？這些都跟車車進入node的穩定性有關。
    * 函數整理表很棒！但怎麼只有Arduino的呢QQ，比較不會寫python更需要多寫說明讓自己知道當初寫的時候在想甚麼，後面debug的時候才不會為了看懂不熟悉的語言而花更多時間。加油~
    </font>
    > [name=erik]

* 教授批閱欄
    * 教授評分等第
    A-
    * 教授回饋
    -你們目前的轉彎方式是全程偵測及判斷嗎? 印象中前兩年採用類似做法的組別都遇到不少困難。轉彎方格的邊角都可能造出特殊的例外狀況，要小心處理。

    > [name=Ho-Lin]
## 第十一週紀錄
* 主題：指定題進度檢視、補救教學
- CHECKPOINTS
	- 車車
		- [x] 循跡
		- [x] 可以偵測到 node(包含十字路口和死巷）
		- [x] 偵測到 node 之後，穩定直走、轉彎、迴轉（寫死指令）
		- [x] 可以接收來自電腦的藍芽指令

	- python
		- [x] 完成基本的 BFS
		- [x] 完成第一題的設計
		- [x] 可以透過藍芽傳輸指令

	- combined
		- [x] 可以讀取 RFID 的值
		- [x] 能走完 3 個點
		- [x] 可以不輔助的情況下，完成小型 E 字地圖
		- [ ] 可以不輔助的情況下，完成進階地圖 
		( 不一定，在某些特定點會轉彎失誤 )
		- [x] 可以正確在死巷讀取 RFID
    > 給助教檢查[name=助教姓名]
* 預計完成事項 (必填)
    * **上課前：**
        * 完成一個可以走完小迷宮的版本<font color=orange>（部分完成）</font>
        * 更換萬向輪 <font color=green>（完成）</font>
        * 設計python第一題的算法<font color=orange>（部分完成）</font>
    * **上課時間：**
        * 把在家裡測試過的車車拿來在進階地圖上完整跑完<font color=red>（未完成）</font>
        * 完成check point 所有該做事項<font color=orange>（部分完成）</font>
        * 對車車轉彎參數繼續進行微調<font color=orange>（部分完成）</font>
    * **下課後自行組裝時間：**
        * 讓車車可以不依靠外力輔助的情況走完進階迷宮<font color=green>（完成）</font>
        * 將Bluetooth、RFID合併到控制車車移動的主程式中<font color=green>（完成）</font>
        * Python能夠發指令給Arduino<font color=green>（完成）</font>
        * 車子能夠偵測到RFID並回傳給python程式<font color=green>（完成）</font>
* 實際達成事項 (必填)
    * 上課前：
        * 將萬向輪換回原本的並上油
           * 雖然我們之前發現把萬向輪換成球形的會讓車子跑的更順
           * 但是球形萬向輪易卡住，如果大多時間都是直線，原本的萬向輪會更穩定
        * 基本的左轉右轉迴轉直走
           * 程式碼：src_7
           * 左轉右轉測試100次無失誤
           * 右轉影片：
           * E字形影片：
        * python的演算法<font color=orange>（部分完成）</font>
           * 寫好演算法中`get_dirc()`、`strategy1()`、`strategy2()`
           * 目前採用greedy algorithm
           * 之後系統穩定後會嘗試**局部最佳化**
           
    * 上課時間：
        * 有在地圖上不依靠外力成功跑完過兩次，但常常在固定兩個點內出軌。
        影片連結：
    * 下課後自行組裝時間：(裝屍時間)
* 組內討論事項 (必填)
    * 調降降壓模組的電壓：
       * 由於第一組Arduino板燒壞的問題，我們也檢討自己的板子會不會電壓太高
       * 調整電壓可能會改變參數，所以還在討論
       
    * 取消激進版：
       * 我們目前暫時停止了激進版的開發
       * 因為我們發現優化保守版更容易，而且效果不差
       * 因應新的規劃的分工見下：
* 組員分工（必填）
    * **吉鈞**：調整參數優化循跡，硬體維護
    * **彥宇**：Arduino程式管理
    * **有齊**：Python演算法

* 遇到的問題、處理狀況、解決方式 (必填)

     * 轉彎會爆衝<font color=green>（已解決）</font>
         * 程式碼：src_7
            * 原程式碼：
              ```cpp 
              while(某個條件下)｛
                 MotorWrting(vL,vR);
               ｝
               ```
            * 新程式碼：
              ```cpp
              while(某個條件下){        
                MotorWriting(vL,vR);
                delay(50);
                MotorWriting(0,0);
                delay(40);
              }
              ```          
         * 如果施加電壓的時間太久，車子就會有明顯的加速減速，煞車會打滑不易控制
         * 改成隔一段小區間交替施電壓和煞車，這樣就不容易過衝
         * **缺點：delay的時候不能接受其他指令**
     * 轉彎的停止判斷<font color=green>（已解決）</font>
          * 若是使用**偵測黑線**來決定停止轉彎
          * 會有一下2個容易出事的點（紅圈）
            ![](https://i.imgur.com/VzyxOFX.jpg)
          * 解決方案 
              * 1. 往前一小段距離
              * 2. 盲轉一段時間
              * 3. 最後再開啟偵測
              ![](https://i.imgur.com/ct5w4qm.jpg)
    * 在node上會走偏<font color=green>（已解決）</font>
       * 我們在node上設計循跡功能
          * 當偵測到白色就稍微偏轉
          * 影片：
       * 增加循跡的穩定性
          *  我們以前一直使用**分情況討論**，原本想改用P Control，但是**分情況討論比p control更有彈性**
    * 上課時間右轉突然爛掉<font color=orange>（部分解決）</font>
       * 上課的時候右轉突然失控
       * 搞了半天發現固定萬向輪的螺絲鬆了，卡到萬向輪
       * 不過轉好螺絲之後還是會爛掉
       * 最後我們改程式架構
         * 原本程式都是靠`loop()`在迴圈，用if判斷
         * 後來直接把每個函數包起來，只執行一次然後執行完再回到主函式
         * **後遺症：不能隨時收藍牙訊息**
    * 邊走邊測RFID時會爛掉<font color=orange>（部分解決）</font>
       * 我把`detectUID()`放進`tracking()`和`onnode_mode()`，然後循跡就爛掉了
     ![](https://i.imgur.com/a9WOxea.gif)
        * 我推測是detect的延遲導致循跡爛掉
    * 直走可能會抓不到線<font color=orange>（部分解決）</font>

* 課程建議 (選填)
    * 待填
* 想說的話 (選填)
    * 有齊：我發現很多時候我們會急著在最新的程式架構裡面做改版，或是直接寫好一個架構，然後冀望車子能夠完全照著自己的意思走。但是最近我發現這種方法幾乎肯定會失敗，而且會把整個程式寫到爛掉，所以我們前面花了一個禮拜弄不出轉彎，很大的程度就是操之過急的結果。本週我們從頭開始測試，一開始的程式像是這樣：
      ```cpp
      void loop(){
       MotorWriting(90,-120);
       delay(50);
       MotorWriting(0,0);  
       delay(40);
      }
      ```
      把直走轉彎參數調到好才進行下一步，結果不用四個小時我們就成功讓車子左轉右轉各100次而沒有失誤，所以我覺得面對這種大型專案真的是急不得，要有穩健和明確的步調才容易成功。
    


## 第十一週批閱區
* 助教批閱欄
    * 助教回饋
    感覺得出你們很認真的測試各種情境，想說的話的部分真的是心有戚戚焉，只能說加油啦XD
    > [name=binomial_wu]
* 教授批閱欄
    * 教授評分等第
    A+
    * 教授回饋
        1. 個人完全同意:「我覺得面對這種大型專案真的是急不得，要有穩健和明確的步調才容易成功。」未來如果繼續升學做研究，或是出去工作做專案，都是這樣的情況。
        2. 轉彎判斷與解決方式的圖示，個人覺得說明得很清楚。
        3. 「可以不輔助的情況下，完成進階地圖 (不一定，在某些特定點會轉彎失誤)」，可多觀察是哪些特定點，車車進入的角度是什麼造成後續的出軌? 再試著做更細膩的處理囉。
     > [name=Jiun-Peng]




## 第十二週紀錄
* 預計達成事項(必填)
    * 解決前進容易出軌的問題<font color = green>**(已解決)**</font>
    * 解決誤判邊角為軌道而切換成循跡模式的出軌<font color = orange>**(有構想尚未完成)**</font>
    * python game 2 演算法<font color = green>**(已解決)**</font>
    * python game 1 演算法<font color = green>**(已完成)**</font>
    * python 指令傳給Arduino<font color = green>**(已完成)**</font>
    * python scoreboard 整合<font color = green>**(已完成)**</font>
    * 在端點沒測到RFID要再掃一次<font color = red>**(未完成)**</font>

* 實際達成事項(必填)
    * 解決前進容易出軌的問題<font color = green>**(已解決)**</font>
    * python game 2 演算法<font color = green>**(已解決)**</font>
    
        * 經過好友鼎力相助以及肝的相挺，我終於敲出來啦~~~
        * 使用`medium_maze.csv`測試：
        * input:
        ```
        Enter number of nodes : 5
        1
        9
        7
        1
        12
        ```
        * output
        ```
        ['S', 'F', 'L', 'F', 'U', 'F', 'R', 'R', 'L', 'R', 'U', 'L', 'R', 'R', 'U', 'L', 'F', 'F', 'R', 'H']
        ```
    * python 1 演算法
        * 我最後還是使用了greedy algorithm
        * 在中地圖上可以跑出不錯的結果，不過仍然不是最佳解
        * 我們用greedy algorithm吐出點的順序後
        * 再用game 2 的函數把這些點換成指令

    * python 指令傳給Arduino<font color = green>**(已完成)**</font>
        * 我們會在一開始的時候把所有指令傳給車子
        * 然後Arduino會有一個char陣列存所有指令
        * 之後車子會照個這些指令走
        * 要預留多少空間給指令陣列呢？
            * 其實不用很多
            * 我們兩種game的計時結果：
                * game 1 指令列`LLRULLFLUFULFFLLFH`(17個指令)，費時**82秒**
                * game 2 指令列`LLRULLFLURFFLLFUFRRFFRH`(22個指令)，費時**93秒**
            * 所以一個指令平均要**4~5秒**
            * 因此兩分鐘內的極限大概就是30到40個指令了
            * 這可以被用在優化game 1 的策略規劃
        
    * python scoreboard 整合<font color = green>**(已完成)**</font>
        ![](https://i.imgur.com/VqBTKD4.jpg)
        ![](https://i.imgur.com/ivZQFO6.jpg)
        這樣應該表示成功了吧....
        

        

* 組內討論事項 (必填)
   * 下週正式跑迷宮前的checklist:
      * 電池一定要充飽
      * 紅外線讀數是否正常
      * 所有的螺絲是否鎖好
      * 電池要固定
      * 每一條線都要壓一壓確認接觸良好

 
* 組員分工 (必填)
    * 有齊:　演算法修正


    * 吉鈞:　直行參數測試


    * 彥宇:　轉彎參數測試




* 遇到的問題、處理狀況、解決方式 (必填)
    * 
    * （上週）偵測RFID時會爛掉
        * 後來我發現程式會爛掉是因為我的程式有機會刪到Null指標
        * 因此我把一些原本動態配置的空間改成全域變數，解決了問題。
    * 進入Node前的不穩定
        * 發現只要起始狀態為23亮，無論車身多傾斜，都能迅速在進入下一個node錢轉正平順地進入node。
        * 所以把所有進入node前的不穩定歸因於起始狀態並非23亮。
        * 雖然上述模式可以透過on node的尋跡修正，但因為時間效率較差，仍希望再進入node前就精準一些。
        * 解決辦法:修正tracking，使得就算處於邊角，也能平順進入Node，而可不使用on node 尋跡。  
        ``` cpp
        const static double degree_R[11] = {1.4 , 1.35 , 1.3 , 1.25 , 1.2 , 1.0 , 0.8 , 0.6 , 0.4 , -0.1 ,         -0.2};
        const static double degree_L[11] = {-0.2, 0.1 , 0.4 , 0.6 , 0.8 , 1.0 , 1.2 , 1.25 , 1.3 , 1.35 ,  1.4};
        const static double reduction[11] = {-30, -20 , -10 , -10 ,  -10  ,  20 ,  -10  , -10 , -10 , -20 , -30 };
        ```
    * 提高尋跡速度
        * 很好辦到，但進入node的減速很重要，正在嘗試分段煞車
   * 想增加on node的穩定度並加快on node的推進速度
       * 觀察得到，在node慢慢移動都會很穩定，但一離開node就會發現歪掉
       *  設想是說，數次數使尋跡作用一段時間確保真的準了，即用一個較快的直行速度出node。
       *  或是對直行時的左右速度進行更精細的修正，確保在為小距離內是直的。
       *  此外出node再往前推進的毫秒數，將是最後決定的參數，有發現可能需要就前方黑線的有無分情況設定

   * 想提高轉彎速度
       * 但這部分是最不敢做的，感覺穩定度會急遽下降
       * 但仍想要透過提高速度並提高頻率來試著執行看看 
   * 前進容易出軌的問題<font color = green>**(已解決)**</font>
       * 前進常因為在node上尋跡的不穩定，而一出node就偵測到全白
       * 影片：
       * 當指令為'F'(前進)時的做法(修改前)
        ```flow
        st=>start: 循跡模式
        op2=>operation: on node 模式
        e=>end: 循跡模式
        st->op2->e
        ```
        * 修改後
        ```flow
        st=>start: 循跡模式
        op2=>operation: on node 模式
        op3=>operation: 往前一小段距離
        op4=>operation: 左轉一段時間
        op5=>operation: 右轉
        cond=>condition: 偵測到線
        cond2=>condition: 偵測到線
        cond3=>condition: 偵測到線
        e=>end: 循跡模式
        e2=>end: 循跡模式
        e3=>end: 循跡模式
        st->op2->op3->cond
        cond(yes)->e
        cond(no)->op4->cond2
        cond2(yes)->e2
        cond2(no)->op5->cond3
        cond3(yes)->e3
        cond3(no)->op5
        
        ```
              
    * 誤判邊角為軌道而切換成循跡模式的出軌<font color = orange>**(有構想尚未完成)**</font>
        * 當車子發現循跡爛掉的時候
        * 停下來，左看看，右看看
        * 類似上面的方法
        * 兩個都實作就可以有雙重保障

    * python game 1 演算法<font color = orange>**(有構想尚未完成)**</font>
    * python 指令傳給Arduino<font color = orange>**(有構想尚未完成)**</font>
    * python scoreboard 整合<font color = red>**(未完成)**</font>
    * 出node 左右搖擺的啟動機制<font color = green>**(已完成)**</font>
        * 出node全白即啟動，目前跑兩分鐘約需要啟動一次 
    * 指令亂掉的解決方案
        * 透過pygame 產生介面顯示顯示車子認為他現在在哪，可以和車子時在地圖上的位置比較偵錯，下禮拜紀錄有更詳細說明
    * 電壓
        * 調整至輸入6V，電池使用範圍縮減至90%~100%

* 課程建議 (選填)

* 想說的話 (選填)
    * 彥宇：因為上週在測試車子的時候，我們發現arduino的板子過熱，所以我們決定降壓。然後我發現當arduino的工作電壓越低時，電池供給電壓的變化對輪子的影響會更明顯，也就是說電池必須常常保持充滿。想請問一下助教有發現這個狀況嗎？


## 第十二週批閱區
* 助教批閱欄
    * 彥宇～電池的確必須常常保持充滿，以前我們在實作的時候不是用現在這顆電池，是一般充電電池，我們有時候來不及充電還會直接充電拉著延長線跑（超像在遛車車lol 其實應該就是我們用的馬達太便宜所以就很不穩定
    * 進度依然很棒，我看到連scoreboard 整合都完成了，如果都有順利讀到rfid，game1費時82秒這個時間感覺非常充足
    * 對了，我覺得流程圖超棒超請楚易讀
    * 這個部分“下週正式跑迷宮前的checklist”可以跟同學分享一下，雖然都是簡單的小事情但就是會造成最後會出錯的原因，你們每次都有細心檢查就沒問題
    [name=yen]
* 教授批閱欄
    * 教授評分等第 A
    
    * 教授回饋 
- 看起來已經做得蠻完整，目前是針對幾個特定的問題在處理，期待你們在接下來的測試中的好表現。
- 演算法即使用 greedy 也可以記錄一下每次是根據什麼條件去做 greedy 選擇。其實這個問題有好幾種不錯的 greedy algorithm。
- 討論的記錄方式，包括流程圖的表現都不錯。請繼續保持。
-Ho-Lin

## 第十三週紀錄
* 課堂應完成事項
    * 系統穩定性測試
    * 監控介面
    * 模擬地圖

* 實際達成事項（必填）
    * 時間計算
        * 為了確認車車在兩分鐘內可以執行多少指令，我們進行測定
        * 指令內容依照地圖隨機產生，有轉彎及直行，也有只有轉彎，或是只有直行的指令
        * title： 
        ```
        test ： 該次測驗編號 (No.X)
        cmd_num ： 該次測驗輸入的指令數 (個)
        time_min ： 所花的時間-分鐘 (minute)
        time_sec ： 所花的時間-秒鐘 (second)
        time_cent ： 所花的時間-百分之一秒 (centisecond)
        
        ave_time ： 平均每個指令所需的時間 (second)
        2min_cmds ： 平均兩分鐘內可執行的指令數 (個)
        
            conclusion ： 
                平均一個指令需花 3.52 秒
                平均兩分鐘內可執行 34 個指令
        ```
        

       ![](https://i.imgur.com/Vkkh4Sq.png)




    * 系統穩定性測試
        * 目前各個循跡方面的問題都大致獲得解決
        * 我們參考了吉鈞的意見減少了在node上的過衝後，直走就變得順利許多
        * 就算直走走偏也會自動左右搖擺找回黑線
        * 接著就是一直走一直走...
        * 有很小的機會會發生失誤，但是我們目前已經不把重點放在避免失誤而是在增加容錯率
        * 因此我們設計了以下的監控介面
    * 監控介面
        * 我們使用pygame來設計介面
        * 當輸入完畢後會跳出一個視窗顯示地圖的樣子
        * 可以用左方向鍵改變圖顯示的方向
        * 然後地圖上會有車子的位置跟方向，如果之後車子出錯的話我們可以馬上把車子移動到正確的位置
        * 不多說，直接看影片吧~
        {%youtube jtM53H00WcU %}
        Link: https://youtu.be/jtM53H00WcU
    * 模擬地圖
        * 設計地圖給演算法執行，衡量演算法效能
        ![](https://i.imgur.com/A5G7v2Q.jpg)

        * 製作地圖拼圖塊，可以高度彈性的組裝拆解去連結MD402的中地圖與其他地圖形成更大網絡，並在禮拜三晚上提供.csv檔及地圖給大家測試 
        ![](https://i.imgur.com/1VQDWaE.jpg)

        

* 組內討論事項 (必填)
   * 下週正式跑迷宮前的checklist:
      * 電池一定要充飽
      * 紅外線讀數是否正常
      * 所有的螺絲是否鎖好
      * 電池要固定
      * 每一條線都要壓一壓確認接觸良好
    * 下週正式跑迷宮前的todolist:
      * 熟悉路線即特殊node number
      * 試跑兩種路線(30 step , 35 step)路徑
      * 如果有時間測試high speed mode 
      * **熟悉分工及狀況處理**
      * **求救的討論**
    * 正式開始跑迷宮時：
        * Yo Chi在螢幕前大聲報出接下來的指令
        * Giri跟在車子後面看指令有沒有正確執行，並確認監控監控介面，做危機處理，及回報口號
            * 動作回報:左轉，右轉，迴轉
            * 是否收到RFID:得分
            * 指令亂掉:求救 
        * Xavier 注意監控監控介面並危機處理
        * 如果有偏差直接手動改正
        * **如果把車子拿起來，一定要放到正確的node上**
        * **車子不能拿起來，務必確認在searching** 
        * 不要被直行的左右搖擺joke
        * RFID未讀到將停留三秒，手動拉至掃到。
        * **絕對不能讓指令亂掉**
    * 在車上放一隻咖波的圖：
        * 如下圖：
            ![](https://i.imgur.com/rb479ol.png)
        * 吉鈞用ppt畫的
    
 
* 組員分工 (必填)
    * 有齊:　python介面，最後測試，以及狀況分析討論，新增指令列因錯亂的shift，high speed mode參數調整


    * 吉鈞:　畫一隻可愛的咖波、生成測試地圖，拼圖，最後測試，以及狀況分析討論


    * 彥宇: 調整參數、生成測試地圖，最後測試，以及狀況分析討論，買乖乖




* 遇到的問題、處理狀況、解決方式 (必填)
    * Pygame的使用
        * 其實也沒什麼，就是看看說明書就好
    * UID造成的delay
        * 我們發現偵測UID會讓一切都很卡
        * Python會卡，車子循跡也會卡
        * 車子的部分：
            * 我們讓車子只有在前面是端點的時候，才開啟RFID模組的偵測
            * 所以只有在要進寶藏點的時候車子才會不穩，但也剛好讓它慢一點，增加掃到UID的機率
            * 一旦掃到了，接下來就會關掉RFID的偵測
        * python的部分：
            * 沒辦法，python一定要隨時接收車子傳來的資料
            * 不過我們在一收到車子發回的指令時就更動介面的顯示，所以問題也不大
    * 當藍芽斷線時，會給車子一堆奇怪指令使其暴衝
        * 之前我們都懶得處理，反正都跑完了
        * 不過後來還是怕它亂跑，所以我們看了看藍芽斷線後會發什麼指令
        * 因為那一串指令第一個char是'+'，所以我們就讓車子收到'+'時就會進入休眠狀態

   

* 課程建議 (選填)

* 想說的話 (選填)


## 第十三週批閱區
* 助教批閱欄
    
* 教授批閱欄
    * 教授評分等第
    A+
    * 教授回饋
    比賽開始前，聽到您們三位問我是否可以按一個按鍵，或可以怎樣移動車子，就知道你們有備而來。你們分析與解決問題很有條理，分工也很好，團隊合作也很有默契，希望你們這學期後有類似的課程，都可以繼續合作，發揮 1+1+1 > 3 的成果喔。 :D
     > [name=Jiun-Peng]
    
    
    
## 第十四週紀錄
* 主題：自選專題設計、製作與進度報告
* 預計完成事項 (必填)
    * 大綱
       *  動機: 
           *  鋼鐵擂台
           *  說明，做姿勢感測，並讓車子做出動作 
       *  設計:
           *  感測端:
               *  遙控器:
                   * 控制車子方向，及手臂底座旋轉角度
                   * 採用握把式。搖桿，或按鍵式，或使用G sensor
                   * wii
               *  通訊:
                   * 藍芽
                   * 與車子的機械手臂通訊
               *  板子:
                   * Mega
                   * Uno 
               *  感測器
                   * 感測手臂姿勢及手掌抓取動作 
                       * 手臂:G sensor， Compass sensor
                       * 手掌:G sensor，Flex sensor
           *  車子端: 
               *  手臂:
                   * 手臂示意圖 
                   ![](https://i.imgur.com/a6NYGpd.gif)
                   出處：https://reurl.cc/62kXyV
               *  馬達
                   *  伺服馬達加舵機
               *  去掉RFID及紅外線傳感器
       *  會遇到的問題:
           *  腳位控制:
               *  G sensor 2
               *  Compass 2
               *  伺服馬達加舵機 4
               *  藍芽 4
               *  按鍵 ?
               *  I2C
           *  感應手部動作:
               *  手臂：
                   *  G sensor：負責感測除了水平移動以外的手部動作，在手臂上裝至少三個G sensor，其中兩個平行手肘內側(編號1,2)，另外一個垂直他們(編號3)。其中，1號及2號分別裝在手肘前後，當手肘彎曲時，就可以藉由這兩組G sensor感應出動作。而3號sensor負責偵測手肘的旋轉。但是因為G sensor是靠重力變化感測其相對位置，所以當他在同一個重力平面上時(也就是水平移動)，就無能為力了，這個時候就需要compass sensor來輔助。
                   *  Compass sensor：用來彌補G sensor的不足。利用地磁變化判斷水平方向的移動(類似指南針的概念)。
               *  手掌：
                   *  G sensor：
                   *  Flex sensor：
                   *  如果不行採用超聲波模組進行測距來衡量抓取動作
           *  車子控制方式：
               *  搖桿、按鍵式：將遙控器握於手中，需用手指操控車前後左右行動
               *  G sensor：一樣將遙控器握在手中，利用G sensor來感測手部動作，並依此來操控車子。例如，遙控器前傾，車子往前；遙控器後傾，車子往後，以此類推。

       *  可行性評估:
           * Yo Chi 心得 :
           * 原本想先問一下教授這個計畫可不可行（技術上）
           * 但後來發現MKS有材料，所以如果能夠直接做出來，就一定可行啦😂
           * 以下為一些一定要成功項目：
              * 用兩個g sensor測角度：**成功**
              * 伺服馬達可以轉到指定的角度：**成功**
              * 兩個藍芽互傳資訊：**成功**（其中一個要HC05）
              * 機械手臂製作：**可行**考慮用買的😆
       *  參考資料
       *  預算:
       *  分工與時程:
           *  分路 
       *  材料清單:
       *  |名稱|單價|數量|總金額|備註|
          |-|-|-|-|-|
          | MPU6050|55|2|110|G sensor|
          |機械手臂雷切|30|1|30|板材|
          |Arduino mega 擴展板|129|1|129||
          |SG90|43|9|387|Servo|
          |袖套手套綁帶魔鬼沾冰棒棍|325|1|325|穿戴裝置|
          |HC-05|**0**|1|0|藍芽|
          |可變電阻|**0**|6|0|穿戴裝置|


       *  預期成果:
          * 設備
              * 遙控器連接Mega板
              * 動態感測套組(G sensor + Compass sensor + Flex sensor +HC05 + arduino Mega)連接上車上的藍芽(HC06)
              * 機械手臂接到uno板並受到其控制
              * 圖例：![](https://i.imgur.com/zoOBaLY.png)

          * 操作
              * 動態感測套組感測使用者動作，並將其對應到機械手臂上
              * 遙控器控制車子前進方向
          * 呈現
              * 預計會讓車子在demo的時候，不利用循跡，直接利用遙控器控制，並移動到一指定地點，操作機械手臂抓取物品，再把物品放到另一個指定位置上。


          * 題外話 
              * 屌炸天 (by unknown)
              * 彥宇感想：同上

       *  應用
          * 看起來很帥


* 實際達成事項 (必填)
    * 完成g sensor, servo整合
       * 影片
         {%youtube i5jfi3hKDAI%}

* 組內討論事項 (必填)
    * 待填 (如問題、構想、分工合作、時間安排...等等)
    * 自製手臂
       * 我們原本打算採取兩元學長的建議直接買一隻手臂，可是發現網路上買的幾乎都是要自己組裝的⋯⋯
       * 然後另一個學術部學長跟我們說網路上有開放的資源，可以直接下載然後拿去電一雷切
       * 於是我們就切好啦
       * ![](https://i.imgur.com/l8bDg5i.jpg)

* 組員分工 (必填)
    * 吉鈞：
      * 製作簡報、上台報告、研究I2C介面、製作機械手臂
    * 彥宇：
      * 找到使用可變電阻當作量角器的影片、協助測試藍芽
    * 有齊：
      * 測試g sensor、測試SG90(伺服馬達)、測試藍芽、購買零件
* 遇到的問題、處理狀況、解決方式 (必填)
    * 網路上買的機械手臂也是得要自己裝的⋯⋯
      * 我們上**thingiverse.com**搜尋**meArm**就找到了一模一樣的圖
      * 然後拿去電機一館雷射切割
    * 藍芽互傳資訊不成功
      * 後來發現要在AT mode 調整HC-05的baud rate
      * 然後就成功了
    * 找不到量角度的模組
      * 我們一開始很認真地找可以量角度的模組但找不到
      * 後來彥宇找到一個影片
      * 我們才驚覺一個可變電阻就可以搞定⋯⋯
* 課程建議 (選填)
    * 待填
* 想說的話 (選填)
    * 待填

## 第十四週批閱區
* 助教批閱欄
    * 助教回饋
    * 聽起來還是有很多事要做哈哈哈，不過手拿著遙控器要怎麼做抓取的動作啊?還是說是要左右開弓？還有遙控器的資訊要怎麼跟mega版溝通的部分可能也需要花時間研究一下(看你們沒提不知道是已經搞定還是怎樣
    * 大家加油啊
    > [name=erik]
* 教授批閱欄
    * 教授評分等第 A+
    * 教授回饋
- 自選題的目標看起來很有趣，難度應該蠻高，也有幾個不同難度的規劃，很不錯。看起來你們的動作很快，已經開始做一些測試了。期待你們的表現。
    > [name=教授姓名]

###### tags: `電資工程入門設計與實作` `108-2`